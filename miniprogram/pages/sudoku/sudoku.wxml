<!--sudoku.wxml-->
<view class="page-container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="header-bar">
    <view class="badge-pill">
      <text class="label">éš¾åº¦</text>
      <text class="value">{{game.difficulty}}</text>
    </view>
    <view class="badge-pill time">
      <text class="value">{{formattedTime}}</text>
    </view>
  </view>

  <!-- æ•°ç‹¬æ£‹ç›˜åŒºåŸŸï¼šä½¿ç”¨ flex-1 è®©å®ƒå æ®å‰©ä½™ç©ºé—´å¹¶å±…ä¸­ -->
  <view class="board-area">
    <view class="sudoku-board" data-size="{{game.gridSize}}">
      <view 
        wx:for="{{subGrids}}" 
        wx:key="subGrid-{{index}}"
        class="sub-grid"
        data-size="{{game.gridSize}}"
      >
        <view 
          wx:for="{{item.cells}}" 
          wx:for-item="cell"
          wx:key="cell-{{cell.row}}-{{cell.col}}"
          class="cell {{cell.className}}"
          bindtap="selectCell" 
          data-row="{{cell.row}}" 
          data-col="{{cell.col}}"
        >
          <text wx:if="{{cell.value !== 0}}" class="cell-text {{cell.textClass}}">{{cell.value}}</text>
          <view wx:elif="{{cell.hasNotes}}" class="cell-notes">
            <view class="note-grid">
              <text class="note-position note-1 {{cell.noteFlags[1] ? 'visible' : ''}}">1</text>
              <text class="note-position note-2 {{cell.noteFlags[2] ? 'visible' : ''}}">2</text>
              <text class="note-position note-3 {{cell.noteFlags[3] ? 'visible' : ''}}">3</text>
              <text class="note-position note-4 {{cell.noteFlags[4] ? 'visible' : ''}}">4</text>
              <text class="note-position note-5 {{cell.noteFlags[5] ? 'visible' : ''}}">5</text>
              <text class="note-position note-6 {{cell.noteFlags[6] ? 'visible' : ''}}">6</text>
              <text class="note-position note-7 {{cell.noteFlags[7] ? 'visible' : ''}}">7</text>
              <text class="note-position note-8 {{cell.noteFlags[8] ? 'visible' : ''}}">8</text>
              <text class="note-position note-9 {{cell.noteFlags[9] ? 'visible' : ''}}">9</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ§åˆ¶ä¸é”®ç›˜åŒºåŸŸ -->
  <view class="controls-area">
    <!-- å·¥å…·æ  -->
    <view class="toolbar">
      <view class="tool-btn" bindtap="eraseCell">
        <view class="icon-circle">ğŸ§½</view>
        <text>æ“¦é™¤</text>
      </view>
      
      <view class="tool-btn {{isNoteMode ? 'active' : ''}}" bindtap="toggleNoteMode">
        <view class="icon-circle {{isNoteMode ? 'active-bg' : ''}}">âœï¸</view>
        <text>å¤‡æ³¨</text>
        <view class="status-dot {{isNoteMode ? 'on' : ''}}"></view>
      </view>
      
      <view class="tool-btn {{game.checkCount > 0 ? '' : 'disabled'}}" bindtap="checkGame">
        <view class="icon-circle">ğŸ”</view>
        <text>æ£€æŸ¥</text>
        <view wx:if="{{game.checkCount > 0}}" class="count-badge">{{game.checkCount}}</view>
      </view>
      
      <view class="tool-btn {{game.hintCount > 0 ? '' : 'disabled'}}" bindtap="showHint">
        <view class="icon-circle">ğŸ’¡</view>
        <text>æç¤º</text>
        <view wx:if="{{game.hintCount > 0}}" class="count-badge">{{game.hintCount}}</view>
      </view>
    </view>

    <!-- æ•°å­—é”®ç›˜ -->
    <view class="number-keyboard">
      <view 
        wx:for="{{numberRange}}" 
        wx:key="*this"
        class="key-btn" 
        bindtap="inputNumber" 
        data-number="{{item}}"
      >
        {{item}}
      </view>
    </view>
  </view>
</view>

<!-- æ¸¸æˆå®Œæˆå¯¹è¯æ¡† -->
<view wx:if="{{showCompleteDialog}}" class="dialog-mask">
  <view class="complete-card">
    <view class="celebrate-icon">ğŸ†</view>
    <text class="dialog-title">æŒ‘æˆ˜æˆåŠŸ</text>
    
    <view class="result-stats">
      <view class="stat-box">
        <text class="label">éš¾åº¦</text>
        <text class="val">{{game.difficulty}}</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-box">
        <text class="label">ç”¨æ—¶</text>
        <text class="val">{{formattedTime}}</text>
      </view>
    </view>
    
    <view class="action-buttons">
      <button class="action-btn primary" bindtap="playAgain">å†æ¥ä¸€å±€</button>
      <button class="action-btn secondary" bindtap="backToHome">è¿”å›ä¸»é¡µ</button>
    </view>
  </view>
</view>
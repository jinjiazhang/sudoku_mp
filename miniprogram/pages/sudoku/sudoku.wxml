<!--sudoku.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="status-bar">
    <view class="time-display">
      æ—¶é—´: {{formattedTime}}
    </view>
  </view>

  <!-- æ•°ç‹¬æ£‹ç›˜ -->
  <view class="board-container">
    <view class="sudoku-board" data-size="{{game.gridSize}}">
      <view 
        wx:for="{{boardCells}}" 
        wx:key="row-{{item.row}}-col-{{item.col}}"
        class="cell {{item.className}} {{item.borderClass}}"
        bindtap="selectCell" 
        data-row="{{item.row}}" 
        data-col="{{item.col}}"
      >
        <text wx:if="{{item.value !== 0}}" class="cell-text {{item.textClass}}">{{item.value}}</text>
        <view wx:elif="{{item.hasNotes}}" class="cell-notes">
          <view class="note-grid">
            <text class="note-position note-1 {{item.noteFlags[1] ? 'visible' : ''}}">1</text>
            <text class="note-position note-2 {{item.noteFlags[2] ? 'visible' : ''}}">2</text>
            <text class="note-position note-3 {{item.noteFlags[3] ? 'visible' : ''}}">3</text>
            <text class="note-position note-4 {{item.noteFlags[4] ? 'visible' : ''}}">4</text>
            <text class="note-position note-5 {{item.noteFlags[5] ? 'visible' : ''}}">5</text>
            <text class="note-position note-6 {{item.noteFlags[6] ? 'visible' : ''}}">6</text>
            <text class="note-position note-7 {{item.noteFlags[7] ? 'visible' : ''}}">7</text>
            <text class="note-position note-8 {{item.noteFlags[8] ? 'visible' : ''}}">8</text>
            <text class="note-position note-9 {{item.noteFlags[9] ? 'visible' : ''}}">9</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å·¥å…·æ  -->
  <view class="toolbar">
    <view class="tool-button" bindtap="eraseCell">
      <text class="tool-icon">ğŸ§½</text>
      <text class="tool-label">æ“¦é™¤</text>
    </view>
    
    <view class="tool-button {{isNoteMode ? 'active' : ''}}" bindtap="toggleNoteMode">
      <text class="tool-icon flipped">âœï¸</text>
      <text class="tool-label">å¤‡æ³¨</text>
      <view class="badge {{isNoteMode ? 'badge-on' : 'badge-off'}}">{{isNoteMode ? 'ON' : 'OFF'}}</view>
    </view>
    
    <view class="tool-button {{game.checkCount > 0 ? '' : 'disabled'}}" bindtap="checkGame">
      <text class="tool-icon">ğŸ”</text>
      <text class="tool-label">æ£€æŸ¥</text>
      <view wx:if="{{game.checkCount > 0}}" class="badge">{{game.checkCount}}</view>
    </view>
    
    <view class="tool-button {{game.hintCount > 0 ? '' : 'disabled'}}" bindtap="showHint">
      <text class="tool-icon">ğŸ’¡</text>
      <text class="tool-label">æç¤º</text>
      <view wx:if="{{game.hintCount > 0}}" class="badge">{{game.hintCount}}</view>
    </view>
  </view>

  <!-- æ•°å­—è¾“å…¥é”®ç›˜ -->
  <view class="number-keyboard">
    <view 
      wx:for="{{numberRange}}" 
      wx:key="*this"
      class="number-key" 
      bindtap="inputNumber" 
      data-number="{{item}}"
    >
      {{item}}
    </view>
  </view>
</view>

<!-- æ¸¸æˆå®Œæˆå¯¹è¯æ¡† -->
<view wx:if="{{showCompleteDialog}}" class="dialog-mask">
  <view class="complete-dialog">
    <view class="celebrate-icon">âœ¨</view>
    <text class="dialog-title">ğŸ‰å¤ªæ£’äº†ï¼</text>
    <text class="dialog-subtitle">æŒ‘æˆ˜æˆåŠŸ</text>
    
    <!-- æˆç»©ç»Ÿè®¡ -->
    <view class="stats-container">
      <view class="stat-row">
        <text class="stat-label">ğŸ¯ éš¾åº¦</text>
        <text class="stat-value">{{game.difficulty}}</text>
      </view>
      <view class="stat-row">
        <text class="stat-label">â±ï¸ ç”¨æ—¶</text>
        <text class="stat-value">{{formattedTime}}</text>
      </view>
    </view>
    
    <view class="dialog-buttons">
      <button class="dialog-btn primary" bindtap="playAgain">
        <text class="btn-icon">ğŸ”„</text>
        <text>å†æ¥ä¸€å±€</text>
      </button>
      <button class="dialog-btn secondary" bindtap="backToHome">
        <text class="btn-icon">ğŸ </text>
        <text>è¿”å›ä¸»é¡µ</text>
      </button>
    </view>
  </view>
</view>
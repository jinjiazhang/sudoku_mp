<!--gomoku.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="status-bar">
    <view class="status-item">
      <text class="status-label">{{game.currentPlayer === 1 ? 'ä½ çš„å›åˆ' : 'AIæ€è€ƒä¸­...'}}</text>
    </view>
    <view class="status-item">
      <text class="time-display">{{formattedTime}}</text>
    </view>
  </view>

  <!-- æ£‹ç›˜ -->
  <view class="board-container">
    <view class="gomoku-board">
      <view
        wx:for="{{boardData}}"
        wx:for-item="row"
        wx:for-index="rowIndex"
        wx:key="row-{{rowIndex}}"
        class="board-row"
      >
        <view
          wx:for="{{row}}"
          wx:for-item="cell"
          wx:for-index="colIndex"
          wx:key="cell-{{rowIndex}}-{{colIndex}}"
          class="cell {{cell.position}}"
          bindtap="onCellTap"
          data-row="{{cell.row}}"
          data-col="{{cell.col}}"
        >
          <!-- ç½‘æ ¼çº¿ -->
          <view class="line horizontal"></view>
          <view class="line vertical"></view>
          
          <!-- æ˜Ÿä½ -->
          <view wx:if="{{cell.isStarPoint}}" class="star-point"></view>

          <!-- æ£‹å­ -->
          <view
            wx:if="{{cell.stone !== 0}}"
            class="stone {{cell.stone === 1 ? 'black' : 'white'}} {{cell.isLast ? 'last-move' : ''}} {{cell.isWinning ? 'winning' : ''}}"
          ></view>
        </view>
      </view>
    </view>
  </view>

  <!-- å·¥å…·æ  -->
  <view class="toolbar">
    <view class="tool-button {{game.moveHistory.length < 2 || game.gameOver || isThinking ? 'disabled' : ''}}" bindtap="undoMove">
      <text class="tool-icon">â†©ï¸</text>
      <text class="tool-label">æ‚”æ£‹</text>
    </view>

    <view class="tool-button" bindtap="restartGame">
      <text class="tool-icon">ğŸ”„</text>
      <text class="tool-label">é‡æ–°å¼€å§‹</text>
    </view>
  </view>
</view>

<!-- æ¸¸æˆç»“æŸå¯¹è¯æ¡† -->
<view wx:if="{{showCompleteDialog}}" class="dialog-mask">
  <view class="complete-dialog {{game.winner === 1 ? 'win' : game.winner === 2 ? 'lose' : 'draw'}}">
    <view class="result-icon">{{game.winner === 1 ? 'ğŸ‰' : game.winner === 2 ? 'ğŸ˜”' : 'ğŸ¤'}}</view>
    <text class="dialog-title">{{resultText}}</text>
    <text class="dialog-subtitle">ç”¨æ—¶ {{formattedTime}}</text>

    <view class="dialog-buttons">
      <button class="dialog-btn primary" bindtap="playAgain">
        <text class="btn-icon">ğŸ”„</text>
        <text>å†æ¥ä¸€å±€</text>
      </button>
      <button class="dialog-btn secondary" bindtap="backToHome">
        <text class="btn-icon">ğŸ </text>
        <text>è¿”å›ä¸»é¡µ</text>
      </button>
    </view>
  </view>
</view>
